// Pattern scenarios for practice mode

import { PatternInfo, PatternScenario, PatternType, RecognitionQuestion } from './types';

// Pattern information catalog
export const PATTERN_INFO: Record<PatternType, PatternInfo> = {
    // ==================== 反轉型態 ====================
    'head-and-shoulders-top': {
        id: 'head-and-shoulders-top',
        name: '頭肩頂',
        nameEn: 'Head and Shoulders Top',
        description: '典型的反轉型態，出現在上升趨勢末端，預示價格可能反轉向下',
        category: 'reversal',
        signal: 'bearish',
    },
    'head-and-shoulders-bottom': {
        id: 'head-and-shoulders-bottom',
        name: '頭肩底',
        nameEn: 'Head and Shoulders Bottom',
        description: '底部反轉型態，出現在下跌趨勢末端，預示價格可能反轉向上',
        category: 'reversal',
        signal: 'bullish',
    },
    'double-bottom': {
        id: 'double-bottom',
        name: 'W底（雙重底）',
        nameEn: 'Double Bottom',
        description: '兩個相近的低點，中間有反彈高點，預示趨勢反轉向上',
        category: 'reversal',
        signal: 'bullish',
    },
    'double-top': {
        id: 'double-top',
        name: 'M頭（雙重頂）',
        nameEn: 'Double Top',
        description: '兩個相近的高點，中間有回檔低點，預示趨勢反轉向下',
        category: 'reversal',
        signal: 'bearish',
    },
    'triple-top': {
        id: 'triple-top',
        name: '三重頂',
        nameEn: 'Triple Top',
        description: '三個相近的高點，代表買方力道完全耗盡，強烈的賣出信號',
        category: 'reversal',
        signal: 'bearish',
    },
    'triple-bottom': {
        id: 'triple-bottom',
        name: '三重底',
        nameEn: 'Triple Bottom',
        description: '三個相近的低點，代表賣方力道完全耗盡，強烈的買入信號',
        category: 'reversal',
        signal: 'bullish',
    },
    'rounding-bottom': {
        id: 'rounding-bottom',
        name: '圓弧底',
        nameEn: 'Rounding Bottom',
        description: '長期底部反轉型態，價格走勢呈現圓弧形',
        category: 'reversal',
        signal: 'bullish',
    },
    'rounding-top': {
        id: 'rounding-top',
        name: '圓弧頂',
        nameEn: 'Rounding Top',
        description: '長期頂部反轉型態，價格走勢呈現倒圓弧形',
        category: 'reversal',
        signal: 'bearish',
    },
    'island-reversal-top': {
        id: 'island-reversal-top',
        name: '島狀反轉（頂）',
        nameEn: 'Island Reversal Top',
        description: '頂部反轉訊號，由向上跳空後再向下跳空組成',
        category: 'reversal',
        signal: 'bearish',
    },
    'island-reversal-bottom': {
        id: 'island-reversal-bottom',
        name: '島狀反轉（底）',
        nameEn: 'Island Reversal Bottom',
        description: '底部反轉訊號，由向下跳空後再向上跳空組成',
        category: 'reversal',
        signal: 'bullish',
    },
    'rising-wedge': {
        id: 'rising-wedge',
        name: '上升楔形',
        nameEn: 'Rising Wedge',
        description: '價格在收斂的上升通道中運行，通常預示下跌反轉',
        category: 'reversal',
        signal: 'bearish',
    },
    'falling-wedge': {
        id: 'falling-wedge',
        name: '下降楔形',
        nameEn: 'Falling Wedge',
        description: '價格在收斂的下降通道中運行，通常預示上漲反轉',
        category: 'reversal',
        signal: 'bullish',
    },
    'v-bottom': {
        id: 'v-bottom',
        name: 'V型底',
        nameEn: 'V-Bottom',
        description: '急速下跌後快速反彈形成V字形，代表強烈的底部反轉',
        category: 'reversal',
        signal: 'bullish',
    },
    'v-top': {
        id: 'v-top',
        name: '倒V型頂',
        nameEn: 'V-Top',
        description: '急速上漲後快速下跌形成倒V字形，代表強烈的頂部反轉',
        category: 'reversal',
        signal: 'bearish',
    },
    // ==================== K線型態 ====================
    'morning-star': {
        id: 'morning-star',
        name: '晨星',
        nameEn: 'Morning Star',
        description: '三根K線組成的底部反轉型態，預示下跌趨勢即將結束',
        category: 'reversal',
        signal: 'bullish',
    },
    'evening-star': {
        id: 'evening-star',
        name: '夜星',
        nameEn: 'Evening Star',
        description: '三根K線組成的頂部反轉型態，預示上漲趨勢即將結束',
        category: 'reversal',
        signal: 'bearish',
    },
    'bullish-engulfing': {
        id: 'bullish-engulfing',
        name: '看漲吞噬',
        nameEn: 'Bullish Engulfing',
        description: '陽線實體完全包覆前一根陰線，預示反轉向上',
        category: 'reversal',
        signal: 'bullish',
    },
    'bearish-engulfing': {
        id: 'bearish-engulfing',
        name: '看跌吞噬',
        nameEn: 'Bearish Engulfing',
        description: '陰線實體完全包覆前一根陽線，預示反轉向下',
        category: 'reversal',
        signal: 'bearish',
    },
    'hammer': {
        id: 'hammer',
        name: '錘子線',
        nameEn: 'Hammer',
        description: '下跌趨勢中出現的反轉信號，下影線長、實體小',
        category: 'reversal',
        signal: 'bullish',
    },
    'shooting-star': {
        id: 'shooting-star',
        name: '流星線',
        nameEn: 'Shooting Star',
        description: '上漲趨勢中出現的反轉信號，上影線長、實體小',
        category: 'reversal',
        signal: 'bearish',
    },
    // ==================== 持續型態 ====================
    'ascending-triangle': {
        id: 'ascending-triangle',
        name: '上升三角形',
        nameEn: 'Ascending Triangle',
        description: '高點持平、低點上移，通常為看漲持續型態',
        category: 'continuation',
        signal: 'bullish',
    },
    'descending-triangle': {
        id: 'descending-triangle',
        name: '下降三角形',
        nameEn: 'Descending Triangle',
        description: '低點持平、高點下移，通常為看跌持續型態',
        category: 'continuation',
        signal: 'bearish',
    },
    'symmetric-triangle': {
        id: 'symmetric-triangle',
        name: '對稱三角形',
        nameEn: 'Symmetric Triangle',
        description: '高點下移、低點上移，方向需等待突破確認',
        category: 'consolidation',
        signal: 'neutral',
    },
    'bull-flag': {
        id: 'bull-flag',
        name: '上升旗形',
        nameEn: 'Bull Flag',
        description: '急漲後向下傾斜整理，突破後繼續上漲',
        category: 'continuation',
        signal: 'bullish',
    },
    'bear-flag': {
        id: 'bear-flag',
        name: '下降旗形',
        nameEn: 'Bear Flag',
        description: '急跌後向上傾斜整理，跌破後繼續下跌',
        category: 'continuation',
        signal: 'bearish',
    },
    'bull-pennant': {
        id: 'bull-pennant',
        name: '上升三角旗',
        nameEn: 'Bull Pennant',
        description: '急漲後形成對稱收斂整理，突破後繼續上漲',
        category: 'continuation',
        signal: 'bullish',
    },
    'bear-pennant': {
        id: 'bear-pennant',
        name: '下降三角旗',
        nameEn: 'Bear Pennant',
        description: '急跌後形成對稱收斂整理，跌破後繼續下跌',
        category: 'continuation',
        signal: 'bearish',
    },
    'cup-and-handle': {
        id: 'cup-and-handle',
        name: '杯柄型態',
        nameEn: 'Cup and Handle',
        description: '圓弧底加上杯柄整理，突破後預示大幅上漲',
        category: 'continuation',
        signal: 'bullish',
    },
    // ==================== 整理型態 ====================
    'rectangle': {
        id: 'rectangle',
        name: '矩形整理',
        nameEn: 'Rectangle',
        description: '價格在水平區間內來回震盪，等待方向突破',
        category: 'consolidation',
        signal: 'neutral',
    },
};

// Generate timestamp for candles
const generateTimestamp = (baseTime: number, index: number, intervalMs: number = 60000) => {
    return baseTime + index * intervalMs;
};

const baseTime = Date.now() - 3600000 * 24; // 24 hours ago

// Pattern scenarios for practice
export const PATTERN_SCENARIOS: PatternScenario[] = [
    // ==================== 頭肩頂 (Head and Shoulders Top) ====================
    {
        id: 'hst-001',
        patternType: 'head-and-shoulders-top',
        name: '頭肩頂型態練習 1',
        description: '典型的頭肩頂型態，觀察頸線跌破後的做空時機',
        candles: [
            { open: 100, high: 105, low: 98, close: 104, volume: 50000, timestamp: generateTimestamp(baseTime, 0) },
            { open: 104, high: 112, low: 103, close: 110, volume: 65000, timestamp: generateTimestamp(baseTime, 1), label: '左肩形成' },
            { open: 110, high: 111, low: 102, close: 104, volume: 55000, timestamp: generateTimestamp(baseTime, 2) },
            { open: 104, high: 120, low: 103, close: 118, volume: 80000, timestamp: generateTimestamp(baseTime, 3), label: '頭部創高' },
            { open: 118, high: 119, low: 100, close: 102, volume: 70000, timestamp: generateTimestamp(baseTime, 4), label: '回落' },
            { open: 102, high: 112, low: 101, close: 109, volume: 60000, timestamp: generateTimestamp(baseTime, 5), label: '右肩形成' },
            { open: 109, high: 110, low: 95, close: 96, volume: 90000, timestamp: generateTimestamp(baseTime, 6), label: '跌破頸線' },
            { open: 96, high: 98, low: 88, close: 90, volume: 85000, timestamp: generateTimestamp(baseTime, 7) },
            { open: 90, high: 92, low: 82, close: 85, volume: 75000, timestamp: generateTimestamp(baseTime, 8), label: '續跌' },
        ],
        optimalEntry: { candleIndex: 6, action: 'sell', price: 96, description: '跌破頸線時做空' },
        optimalExit: { candleIndex: 8, action: 'buy', price: 85, description: '目標價附近回補' },
        stopLoss: 105,
        takeProfit: 80,
        expectedDirection: 'down',
        difficulty: 'medium',
    },
    {
        id: 'hst-002',
        patternType: 'head-and-shoulders-top',
        name: '頭肩頂型態練習 2',
        description: '帶有回測頸線的頭肩頂，更佳的做空進場點',
        candles: [
            { open: 85, high: 92, low: 84, close: 90, volume: 45000, timestamp: generateTimestamp(baseTime, 0) },
            { open: 90, high: 100, low: 89, close: 98, volume: 60000, timestamp: generateTimestamp(baseTime, 1), label: '左肩' },
            { open: 98, high: 99, low: 88, close: 90, volume: 50000, timestamp: generateTimestamp(baseTime, 2) },
            { open: 90, high: 108, low: 89, close: 105, volume: 75000, timestamp: generateTimestamp(baseTime, 3), label: '頭部' },
            { open: 105, high: 106, low: 88, close: 90, volume: 65000, timestamp: generateTimestamp(baseTime, 4) },
            { open: 90, high: 99, low: 89, close: 96, volume: 55000, timestamp: generateTimestamp(baseTime, 5), label: '右肩' },
            { open: 96, high: 97, low: 82, close: 84, volume: 85000, timestamp: generateTimestamp(baseTime, 6), label: '跌破頸線' },
            { open: 84, high: 90, low: 83, close: 88, volume: 50000, timestamp: generateTimestamp(baseTime, 7), label: '回測頸線' },
            { open: 88, high: 89, low: 72, close: 75, volume: 90000, timestamp: generateTimestamp(baseTime, 8), label: '續跌' },
        ],
        optimalEntry: { candleIndex: 7, action: 'sell', price: 88, description: '回測頸線時做空' },
        optimalExit: { candleIndex: 8, action: 'buy', price: 75, description: '達到目標價回補' },
        stopLoss: 95,
        takeProfit: 72,
        expectedDirection: 'down',
        difficulty: 'hard',
    },

    // ==================== 頭肩底 (Head and Shoulders Bottom) ====================
    {
        id: 'hsb-001',
        patternType: 'head-and-shoulders-bottom',
        name: '頭肩底型態練習 1',
        description: '底部反轉型態，觀察突破頸線後的買入時機',
        candles: [
            { open: 100, high: 102, low: 88, close: 90, volume: 55000, timestamp: generateTimestamp(baseTime, 0), label: '下跌' },
            { open: 90, high: 92, low: 80, close: 82, volume: 60000, timestamp: generateTimestamp(baseTime, 1), label: '左肩' },
            { open: 82, high: 90, low: 81, close: 88, volume: 50000, timestamp: generateTimestamp(baseTime, 2) },
            { open: 88, high: 89, low: 70, close: 72, volume: 80000, timestamp: generateTimestamp(baseTime, 3), label: '頭部' },
            { open: 72, high: 90, low: 71, close: 88, volume: 65000, timestamp: generateTimestamp(baseTime, 4) },
            { open: 88, high: 89, low: 78, close: 80, volume: 55000, timestamp: generateTimestamp(baseTime, 5), label: '右肩' },
            { open: 80, high: 95, low: 79, close: 93, volume: 90000, timestamp: generateTimestamp(baseTime, 6), label: '突破頸線' },
            { open: 93, high: 105, low: 92, close: 103, volume: 85000, timestamp: generateTimestamp(baseTime, 7), label: '上漲' },
            { open: 103, high: 115, low: 102, close: 112, volume: 80000, timestamp: generateTimestamp(baseTime, 8), label: '目標達' },
        ],
        optimalEntry: { candleIndex: 6, action: 'buy', price: 93, description: '突破頸線時買入' },
        optimalExit: { candleIndex: 8, action: 'sell', price: 112, description: '達到目標價賣出' },
        stopLoss: 75,
        takeProfit: 110,
        expectedDirection: 'up',
        difficulty: 'medium',
    },
    {
        id: 'hsb-002',
        patternType: 'head-and-shoulders-bottom',
        name: '頭肩底型態練習 2',
        description: '帶有回測的頭肩底，確認支撐後買入',
        candles: [
            { open: 95, high: 96, low: 82, close: 84, volume: 50000, timestamp: generateTimestamp(baseTime, 0) },
            { open: 84, high: 86, low: 75, close: 78, volume: 55000, timestamp: generateTimestamp(baseTime, 1), label: '左肩' },
            { open: 78, high: 86, low: 77, close: 84, volume: 45000, timestamp: generateTimestamp(baseTime, 2) },
            { open: 84, high: 85, low: 65, close: 68, volume: 75000, timestamp: generateTimestamp(baseTime, 3), label: '頭部' },
            { open: 68, high: 85, low: 67, close: 83, volume: 60000, timestamp: generateTimestamp(baseTime, 4) },
            { open: 83, high: 84, low: 74, close: 76, volume: 50000, timestamp: generateTimestamp(baseTime, 5), label: '右肩' },
            { open: 76, high: 92, low: 75, close: 90, volume: 85000, timestamp: generateTimestamp(baseTime, 6), label: '突破頸線' },
            { open: 90, high: 91, low: 84, close: 86, volume: 45000, timestamp: generateTimestamp(baseTime, 7), label: '回測頸線' },
            { open: 86, high: 105, low: 85, close: 102, volume: 90000, timestamp: generateTimestamp(baseTime, 8), label: '續漲' },
        ],
        optimalEntry: { candleIndex: 7, action: 'buy', price: 86, description: '回測頸線確認支撐後買入' },
        optimalExit: { candleIndex: 8, action: 'sell', price: 102, description: '達到目標價賣出' },
        stopLoss: 72,
        takeProfit: 100,
        expectedDirection: 'up',
        difficulty: 'hard',
    },

    // ==================== W底 (Double Bottom) ====================
    {
        id: 'db-001',
        patternType: 'double-bottom',
        name: 'W底型態練習 1',
        description: '經典的W底型態，觀察突破頸線後的買入時機',
        candles: [
            { open: 80, high: 82, low: 68, close: 70, volume: 60000, timestamp: generateTimestamp(baseTime, 0), label: '下跌' },
            { open: 70, high: 72, low: 58, close: 60, volume: 75000, timestamp: generateTimestamp(baseTime, 1), label: '第一底' },
            { open: 60, high: 75, low: 59, close: 73, volume: 55000, timestamp: generateTimestamp(baseTime, 2), label: '反彈' },
            { open: 73, high: 74, low: 57, close: 59, volume: 70000, timestamp: generateTimestamp(baseTime, 3), label: '第二底' },
            { open: 59, high: 68, low: 58, close: 66, volume: 50000, timestamp: generateTimestamp(baseTime, 4), label: '起漲' },
            { open: 66, high: 80, low: 65, close: 78, volume: 85000, timestamp: generateTimestamp(baseTime, 5), label: '突破頸線' },
            { open: 78, high: 79, low: 72, close: 74, volume: 45000, timestamp: generateTimestamp(baseTime, 6), label: '回測' },
            { open: 74, high: 92, low: 73, close: 90, volume: 90000, timestamp: generateTimestamp(baseTime, 7), label: '上漲' },
            { open: 90, high: 98, low: 88, close: 96, volume: 80000, timestamp: generateTimestamp(baseTime, 8), label: '目標達' },
        ],
        optimalEntry: { candleIndex: 5, action: 'buy', price: 78, description: '突破頸線時買入' },
        optimalExit: { candleIndex: 8, action: 'sell', price: 96, description: '達到目標價賣出' },
        stopLoss: 55,
        takeProfit: 95,
        expectedDirection: 'up',
        difficulty: 'easy',
    },
    {
        id: 'db-002',
        patternType: 'double-bottom',
        name: 'W底型態練習 2',
        description: '第二底略高於第一底的W底，更強的反轉信號',
        candles: [
            { open: 95, high: 96, low: 78, close: 80, volume: 55000, timestamp: generateTimestamp(baseTime, 0) },
            { open: 80, high: 82, low: 65, close: 68, volume: 70000, timestamp: generateTimestamp(baseTime, 1), label: '第一底' },
            { open: 68, high: 85, low: 67, close: 82, volume: 50000, timestamp: generateTimestamp(baseTime, 2), label: '反彈' },
            { open: 82, high: 83, low: 70, close: 72, volume: 60000, timestamp: generateTimestamp(baseTime, 3), label: '第二底（較高）' },
            { open: 72, high: 90, low: 71, close: 88, volume: 95000, timestamp: generateTimestamp(baseTime, 4), label: '突破頸線' },
            { open: 88, high: 105, low: 86, close: 102, volume: 85000, timestamp: generateTimestamp(baseTime, 5), label: '續漲' },
            { open: 102, high: 115, low: 100, close: 112, volume: 80000, timestamp: generateTimestamp(baseTime, 6), label: '目標達' },
        ],
        optimalEntry: { candleIndex: 4, action: 'buy', price: 85, description: '突破頸線時買入' },
        optimalExit: { candleIndex: 6, action: 'sell', price: 112, description: '達到目標價賣出' },
        stopLoss: 68,
        takeProfit: 110,
        expectedDirection: 'up',
        difficulty: 'medium',
    },

    // ==================== M頭 (Double Top) ====================
    {
        id: 'dt-001',
        patternType: 'double-top',
        name: 'M頭型態練習 1',
        description: '經典的M頭型態，觀察跌破頸線後的做空時機',
        candles: [
            { open: 80, high: 95, low: 78, close: 93, volume: 60000, timestamp: generateTimestamp(baseTime, 0), label: '上漲' },
            { open: 93, high: 102, low: 92, close: 100, volume: 75000, timestamp: generateTimestamp(baseTime, 1), label: '第一頂' },
            { open: 100, high: 101, low: 85, close: 87, volume: 55000, timestamp: generateTimestamp(baseTime, 2), label: '回檔' },
            { open: 87, high: 103, low: 86, close: 101, volume: 70000, timestamp: generateTimestamp(baseTime, 3), label: '第二頂' },
            { open: 101, high: 102, low: 90, close: 92, volume: 50000, timestamp: generateTimestamp(baseTime, 4), label: '回落' },
            { open: 92, high: 93, low: 80, close: 82, volume: 85000, timestamp: generateTimestamp(baseTime, 5), label: '跌破頸線' },
            { open: 82, high: 88, low: 80, close: 86, volume: 45000, timestamp: generateTimestamp(baseTime, 6), label: '反彈' },
            { open: 86, high: 87, low: 70, close: 72, volume: 90000, timestamp: generateTimestamp(baseTime, 7), label: '續跌' },
        ],
        optimalEntry: { candleIndex: 5, action: 'sell', price: 82, description: '跌破頸線時做空' },
        optimalExit: { candleIndex: 7, action: 'buy', price: 72, description: '達到目標價回補' },
        stopLoss: 95,
        takeProfit: 70,
        expectedDirection: 'down',
        difficulty: 'easy',
    },
    {
        id: 'dt-002',
        patternType: 'double-top',
        name: 'M頭型態練習 2',
        description: '第二頂略低於第一頂的M頭，更弱的結構',
        candles: [
            { open: 70, high: 88, low: 68, close: 85, volume: 50000, timestamp: generateTimestamp(baseTime, 0) },
            { open: 85, high: 105, low: 84, close: 102, volume: 80000, timestamp: generateTimestamp(baseTime, 1), label: '第一頂' },
            { open: 102, high: 103, low: 88, close: 90, volume: 55000, timestamp: generateTimestamp(baseTime, 2), label: '回檔' },
            { open: 90, high: 100, low: 89, close: 98, volume: 65000, timestamp: generateTimestamp(baseTime, 3), label: '第二頂（較低）' },
            { open: 98, high: 99, low: 85, close: 86, volume: 75000, timestamp: generateTimestamp(baseTime, 4), label: '跌破頸線' },
            { open: 86, high: 91, low: 78, close: 80, volume: 60000, timestamp: generateTimestamp(baseTime, 5) },
            { open: 80, high: 82, low: 68, close: 70, volume: 85000, timestamp: generateTimestamp(baseTime, 6), label: '續跌' },
        ],
        optimalEntry: { candleIndex: 4, action: 'sell', price: 86, description: '跌破頸線時做空' },
        optimalExit: { candleIndex: 6, action: 'buy', price: 70, description: '達到目標價回補' },
        stopLoss: 100,
        takeProfit: 68,
        expectedDirection: 'down',
        difficulty: 'medium',
    },

    // ==================== 三重頂 (Triple Top) ====================
    {
        id: 'tt-001',
        patternType: 'triple-top',
        name: '三重頂型態練習 1',
        description: '三次測試高點失敗，強烈的賣出信號',
        candles: [
            { open: 85, high: 98, low: 84, close: 96, volume: 55000, timestamp: generateTimestamp(baseTime, 0), label: '上漲' },
            { open: 96, high: 105, low: 95, close: 103, volume: 70000, timestamp: generateTimestamp(baseTime, 1), label: '第一頂' },
            { open: 103, high: 104, low: 92, close: 94, volume: 50000, timestamp: generateTimestamp(baseTime, 2), label: '回檔' },
            { open: 94, high: 106, low: 93, close: 104, volume: 65000, timestamp: generateTimestamp(baseTime, 3), label: '第二頂' },
            { open: 104, high: 105, low: 90, close: 92, volume: 55000, timestamp: generateTimestamp(baseTime, 4), label: '回檔' },
            { open: 92, high: 104, low: 91, close: 102, volume: 60000, timestamp: generateTimestamp(baseTime, 5), label: '第三頂' },
            { open: 102, high: 103, low: 85, close: 87, volume: 90000, timestamp: generateTimestamp(baseTime, 6), label: '跌破頸線' },
            { open: 87, high: 90, low: 75, close: 78, volume: 85000, timestamp: generateTimestamp(baseTime, 7), label: '續跌' },
            { open: 78, high: 80, low: 68, close: 70, volume: 80000, timestamp: generateTimestamp(baseTime, 8), label: '大跌' },
        ],
        optimalEntry: { candleIndex: 6, action: 'sell', price: 87, description: '跌破頸線時做空' },
        optimalExit: { candleIndex: 8, action: 'buy', price: 70, description: '達到目標價回補' },
        stopLoss: 108,
        takeProfit: 68,
        expectedDirection: 'down',
        difficulty: 'hard',
    },
    {
        id: 'tt-002',
        patternType: 'triple-top',
        name: '三重頂型態練習 2',
        description: '逐次降低的三重頂，力道衰竭明顯',
        candles: [
            { open: 80, high: 95, low: 78, close: 92, volume: 50000, timestamp: generateTimestamp(baseTime, 0) },
            { open: 92, high: 110, low: 90, close: 108, volume: 75000, timestamp: generateTimestamp(baseTime, 1), label: '第一頂（最高）' },
            { open: 108, high: 109, low: 95, close: 97, volume: 55000, timestamp: generateTimestamp(baseTime, 2) },
            { open: 97, high: 106, low: 96, close: 104, volume: 60000, timestamp: generateTimestamp(baseTime, 3), label: '第二頂（較低）' },
            { open: 104, high: 105, low: 94, close: 96, volume: 50000, timestamp: generateTimestamp(baseTime, 4) },
            { open: 96, high: 102, low: 95, close: 100, volume: 55000, timestamp: generateTimestamp(baseTime, 5), label: '第三頂（最低）' },
            { open: 100, high: 101, low: 88, close: 90, volume: 85000, timestamp: generateTimestamp(baseTime, 6), label: '跌破頸線' },
            { open: 90, high: 92, low: 78, close: 80, volume: 80000, timestamp: generateTimestamp(baseTime, 7), label: '續跌' },
        ],
        optimalEntry: { candleIndex: 6, action: 'sell', price: 90, description: '跌破頸線時做空' },
        optimalExit: { candleIndex: 7, action: 'buy', price: 80, description: '達到目標價回補' },
        stopLoss: 105,
        takeProfit: 78,
        expectedDirection: 'down',
        difficulty: 'medium',
    },

    // ==================== 三重底 (Triple Bottom) ====================
    {
        id: 'tb-001',
        patternType: 'triple-bottom',
        name: '三重底型態練習 1',
        description: '三次測試低點支撐，強烈的買入信號',
        candles: [
            { open: 90, high: 92, low: 78, close: 80, volume: 55000, timestamp: generateTimestamp(baseTime, 0), label: '下跌' },
            { open: 80, high: 82, low: 68, close: 70, volume: 70000, timestamp: generateTimestamp(baseTime, 1), label: '第一底' },
            { open: 70, high: 82, low: 69, close: 80, volume: 50000, timestamp: generateTimestamp(baseTime, 2), label: '反彈' },
            { open: 80, high: 81, low: 67, close: 69, volume: 65000, timestamp: generateTimestamp(baseTime, 3), label: '第二底' },
            { open: 69, high: 80, low: 68, close: 78, volume: 55000, timestamp: generateTimestamp(baseTime, 4), label: '反彈' },
            { open: 78, high: 79, low: 68, close: 70, volume: 60000, timestamp: generateTimestamp(baseTime, 5), label: '第三底' },
            { open: 70, high: 88, low: 69, close: 86, volume: 90000, timestamp: generateTimestamp(baseTime, 6), label: '突破頸線' },
            { open: 86, high: 100, low: 84, close: 98, volume: 85000, timestamp: generateTimestamp(baseTime, 7), label: '續漲' },
            { open: 98, high: 112, low: 96, close: 110, volume: 80000, timestamp: generateTimestamp(baseTime, 8), label: '大漲' },
        ],
        optimalEntry: { candleIndex: 6, action: 'buy', price: 86, description: '突破頸線時買入' },
        optimalExit: { candleIndex: 8, action: 'sell', price: 110, description: '達到目標價賣出' },
        stopLoss: 65,
        takeProfit: 108,
        expectedDirection: 'up',
        difficulty: 'hard',
    },

    // ==================== 上升三角形 (Ascending Triangle) ====================
    {
        id: 'at-001',
        patternType: 'ascending-triangle',
        name: '上升三角形練習 1',
        description: '上升三角形整理後突破，觀察買入時機',
        candles: [
            { open: 88, high: 97, low: 85, close: 95, volume: 50000, timestamp: generateTimestamp(baseTime, 0) },
            { open: 95, high: 100, low: 90, close: 92, volume: 55000, timestamp: generateTimestamp(baseTime, 1), label: '壓力線' },
            { open: 92, high: 100, low: 91, close: 98, volume: 48000, timestamp: generateTimestamp(baseTime, 2) },
            { open: 98, high: 101, low: 93, close: 94, volume: 52000, timestamp: generateTimestamp(baseTime, 3), label: '測壓力' },
            { open: 94, high: 100, low: 93, close: 99, volume: 50000, timestamp: generateTimestamp(baseTime, 4) },
            { open: 99, high: 100, low: 95, close: 96, volume: 45000, timestamp: generateTimestamp(baseTime, 5), label: '蓄勢' },
            { open: 96, high: 110, low: 95, close: 108, volume: 95000, timestamp: generateTimestamp(baseTime, 6), label: '突破!' },
            { open: 108, high: 118, low: 106, close: 115, volume: 85000, timestamp: generateTimestamp(baseTime, 7), label: '續漲' },
        ],
        optimalEntry: { candleIndex: 6, action: 'buy', price: 102, description: '突破壓力線時買入' },
        optimalExit: { candleIndex: 7, action: 'sell', price: 115, description: '達到目標價賣出' },
        stopLoss: 92,
        takeProfit: 115,
        expectedDirection: 'up',
        difficulty: 'easy',
    },
    {
        id: 'at-002',
        patternType: 'ascending-triangle',
        name: '上升三角形練習 2',
        description: '多次測試壓力線的上升三角形',
        candles: [
            { open: 75, high: 85, low: 74, close: 83, volume: 45000, timestamp: generateTimestamp(baseTime, 0) },
            { open: 83, high: 90, low: 80, close: 82, volume: 50000, timestamp: generateTimestamp(baseTime, 1), label: '壓力線' },
            { open: 82, high: 90, low: 81, close: 88, volume: 48000, timestamp: generateTimestamp(baseTime, 2) },
            { open: 88, high: 91, low: 84, close: 85, volume: 45000, timestamp: generateTimestamp(baseTime, 3) },
            { open: 85, high: 90, low: 84, close: 89, volume: 52000, timestamp: generateTimestamp(baseTime, 4), label: '測壓力' },
            { open: 89, high: 91, low: 86, close: 87, volume: 48000, timestamp: generateTimestamp(baseTime, 5) },
            { open: 87, high: 102, low: 86, close: 100, volume: 110000, timestamp: generateTimestamp(baseTime, 6), label: '突破!' },
            { open: 100, high: 112, low: 98, close: 110, volume: 90000, timestamp: generateTimestamp(baseTime, 7), label: '續漲' },
        ],
        optimalEntry: { candleIndex: 6, action: 'buy', price: 92, description: '突破壓力線時買入' },
        optimalExit: { candleIndex: 7, action: 'sell', price: 110, description: '達到目標價賣出' },
        stopLoss: 84,
        takeProfit: 108,
        expectedDirection: 'up',
        difficulty: 'medium',
    },

    // ==================== 下降三角形 (Descending Triangle) ====================
    {
        id: 'dct-001',
        patternType: 'descending-triangle',
        name: '下降三角形練習 1',
        description: '下降三角形跌破，觀察做空時機',
        candles: [
            { open: 100, high: 105, low: 85, close: 88, volume: 60000, timestamp: generateTimestamp(baseTime, 0) },
            { open: 88, high: 95, low: 80, close: 82, volume: 55000, timestamp: generateTimestamp(baseTime, 1), label: '支撐線' },
            { open: 82, high: 92, low: 80, close: 90, volume: 50000, timestamp: generateTimestamp(baseTime, 2) },
            { open: 90, high: 91, low: 80, close: 82, volume: 48000, timestamp: generateTimestamp(baseTime, 3), label: '測支撐' },
            { open: 82, high: 88, low: 80, close: 85, volume: 45000, timestamp: generateTimestamp(baseTime, 4) },
            { open: 85, high: 86, low: 70, close: 72, volume: 90000, timestamp: generateTimestamp(baseTime, 5), label: '跌破!' },
            { open: 72, high: 75, low: 60, close: 62, volume: 85000, timestamp: generateTimestamp(baseTime, 6), label: '續跌' },
        ],
        optimalEntry: { candleIndex: 5, action: 'sell', price: 78, description: '跌破支撐線時做空' },
        optimalExit: { candleIndex: 6, action: 'buy', price: 62, description: '達到目標價回補' },
        stopLoss: 92,
        takeProfit: 60,
        expectedDirection: 'down',
        difficulty: 'medium',
    },

    // ==================== 上升旗形 (Bull Flag) ====================
    {
        id: 'bf-001',
        patternType: 'bull-flag',
        name: '上升旗形練習 1',
        description: '急漲後整理形成旗形，觀察突破買入時機',
        candles: [
            { open: 50, high: 68, low: 49, close: 67, volume: 90000, timestamp: generateTimestamp(baseTime, 0), label: '旗竿' },
            { open: 67, high: 69, low: 62, close: 64, volume: 45000, timestamp: generateTimestamp(baseTime, 1), label: '整理1' },
            { open: 64, high: 66, low: 60, close: 62, volume: 40000, timestamp: generateTimestamp(baseTime, 2), label: '整理2' },
            { open: 62, high: 64, low: 58, close: 60, volume: 38000, timestamp: generateTimestamp(baseTime, 3), label: '整理3' },
            { open: 60, high: 78, low: 59, close: 76, volume: 100000, timestamp: generateTimestamp(baseTime, 4), label: '突破!' },
            { open: 76, high: 88, low: 75, close: 85, volume: 85000, timestamp: generateTimestamp(baseTime, 5), label: '大漲' },
        ],
        optimalEntry: { candleIndex: 4, action: 'buy', price: 65, description: '突破旗身上緣時買入' },
        optimalExit: { candleIndex: 5, action: 'sell', price: 85, description: '達到目標價賣出' },
        stopLoss: 56,
        takeProfit: 85,
        expectedDirection: 'up',
        difficulty: 'medium',
    },

    // ==================== 下降旗形 (Bear Flag) ====================
    {
        id: 'brf-001',
        patternType: 'bear-flag',
        name: '下降旗形練習 1',
        description: '急跌後反彈整理形成旗形，觀察跌破做空時機',
        candles: [
            { open: 100, high: 102, low: 82, close: 84, volume: 95000, timestamp: generateTimestamp(baseTime, 0), label: '旗竿' },
            { open: 84, high: 90, low: 83, close: 88, volume: 45000, timestamp: generateTimestamp(baseTime, 1), label: '反彈1' },
            { open: 88, high: 94, low: 87, close: 92, volume: 40000, timestamp: generateTimestamp(baseTime, 2), label: '反彈2' },
            { open: 92, high: 96, low: 90, close: 94, volume: 38000, timestamp: generateTimestamp(baseTime, 3), label: '反彈3' },
            { open: 94, high: 95, low: 75, close: 78, volume: 100000, timestamp: generateTimestamp(baseTime, 4), label: '跌破!' },
            { open: 78, high: 80, low: 65, close: 68, volume: 85000, timestamp: generateTimestamp(baseTime, 5), label: '續跌' },
        ],
        optimalEntry: { candleIndex: 4, action: 'sell', price: 88, description: '跌破旗身下緣時做空' },
        optimalExit: { candleIndex: 5, action: 'buy', price: 68, description: '達到目標價回補' },
        stopLoss: 98,
        takeProfit: 65,
        expectedDirection: 'down',
        difficulty: 'medium',
    },

    // ==================== 上升三角旗 (Bull Pennant) ====================
    {
        id: 'bp-001',
        patternType: 'bull-pennant',
        name: '上升三角旗練習 1',
        description: '急漲後形成對稱收斂整理，觀察突破時機',
        candles: [
            { open: 50, high: 72, low: 49, close: 70, volume: 95000, timestamp: generateTimestamp(baseTime, 0), label: '旗竿' },
            { open: 70, high: 73, low: 64, close: 66, volume: 50000, timestamp: generateTimestamp(baseTime, 1), label: '整理' },
            { open: 66, high: 70, low: 65, close: 68, volume: 45000, timestamp: generateTimestamp(baseTime, 2) },
            { open: 68, high: 69, low: 66, close: 67, volume: 40000, timestamp: generateTimestamp(baseTime, 3), label: '收斂' },
            { open: 67, high: 85, low: 66, close: 83, volume: 110000, timestamp: generateTimestamp(baseTime, 4), label: '突破!' },
            { open: 83, high: 95, low: 81, close: 92, volume: 90000, timestamp: generateTimestamp(baseTime, 5), label: '續漲' },
        ],
        optimalEntry: { candleIndex: 4, action: 'buy', price: 72, description: '突破三角旗上緣時買入' },
        optimalExit: { candleIndex: 5, action: 'sell', price: 92, description: '達到目標價賣出' },
        stopLoss: 62,
        takeProfit: 90,
        expectedDirection: 'up',
        difficulty: 'medium',
    },

    // ==================== 下降三角旗 (Bear Pennant) ====================
    {
        id: 'brp-001',
        patternType: 'bear-pennant',
        name: '下降三角旗練習 1',
        description: '急跌後形成對稱收斂整理，觀察跌破時機',
        candles: [
            { open: 100, high: 102, low: 78, close: 80, volume: 95000, timestamp: generateTimestamp(baseTime, 0), label: '旗竿' },
            { open: 80, high: 88, low: 79, close: 86, volume: 50000, timestamp: generateTimestamp(baseTime, 1), label: '整理' },
            { open: 86, high: 87, low: 82, close: 84, volume: 45000, timestamp: generateTimestamp(baseTime, 2) },
            { open: 84, high: 86, low: 83, close: 85, volume: 40000, timestamp: generateTimestamp(baseTime, 3), label: '收斂' },
            { open: 85, high: 86, low: 68, close: 70, volume: 110000, timestamp: generateTimestamp(baseTime, 4), label: '跌破!' },
            { open: 70, high: 72, low: 58, close: 60, volume: 90000, timestamp: generateTimestamp(baseTime, 5), label: '續跌' },
        ],
        optimalEntry: { candleIndex: 4, action: 'sell', price: 80, description: '跌破三角旗下緣時做空' },
        optimalExit: { candleIndex: 5, action: 'buy', price: 60, description: '達到目標價回補' },
        stopLoss: 90,
        takeProfit: 58,
        expectedDirection: 'down',
        difficulty: 'medium',
    },

    // ==================== 上升楔形 (Rising Wedge) ====================
    {
        id: 'rw-001',
        patternType: 'rising-wedge',
        name: '上升楔形練習 1',
        description: '上升楔形跌破，觀察做空時機',
        candles: [
            { open: 60, high: 68, low: 58, close: 66, volume: 50000, timestamp: generateTimestamp(baseTime, 0) },
            { open: 66, high: 72, low: 64, close: 70, volume: 48000, timestamp: generateTimestamp(baseTime, 1), label: '上升' },
            { open: 70, high: 76, low: 68, close: 74, volume: 45000, timestamp: generateTimestamp(baseTime, 2) },
            { open: 74, high: 80, low: 72, close: 78, volume: 42000, timestamp: generateTimestamp(baseTime, 3), label: '收斂' },
            { open: 78, high: 82, low: 76, close: 80, volume: 40000, timestamp: generateTimestamp(baseTime, 4) },
            { open: 80, high: 83, low: 78, close: 81, volume: 38000, timestamp: generateTimestamp(baseTime, 5), label: '頂部' },
            { open: 81, high: 82, low: 68, close: 70, volume: 90000, timestamp: generateTimestamp(baseTime, 6), label: '跌破!' },
            { open: 70, high: 72, low: 58, close: 60, volume: 85000, timestamp: generateTimestamp(baseTime, 7), label: '續跌' },
        ],
        optimalEntry: { candleIndex: 6, action: 'sell', price: 76, description: '跌破下緣時做空' },
        optimalExit: { candleIndex: 7, action: 'buy', price: 60, description: '達到目標價回補' },
        stopLoss: 84,
        takeProfit: 58,
        expectedDirection: 'down',
        difficulty: 'medium',
    },

    // ==================== 下降楔形 (Falling Wedge) ====================
    {
        id: 'fw-001',
        patternType: 'falling-wedge',
        name: '下降楔形練習 1',
        description: '下降楔形突破，觀察買入時機',
        candles: [
            { open: 90, high: 92, low: 82, close: 84, volume: 50000, timestamp: generateTimestamp(baseTime, 0) },
            { open: 84, high: 86, low: 78, close: 80, volume: 48000, timestamp: generateTimestamp(baseTime, 1), label: '下降' },
            { open: 80, high: 82, low: 74, close: 76, volume: 45000, timestamp: generateTimestamp(baseTime, 2) },
            { open: 76, high: 78, low: 72, close: 74, volume: 42000, timestamp: generateTimestamp(baseTime, 3), label: '收斂' },
            { open: 74, high: 76, low: 70, close: 72, volume: 40000, timestamp: generateTimestamp(baseTime, 4) },
            { open: 72, high: 74, low: 68, close: 70, volume: 38000, timestamp: generateTimestamp(baseTime, 5), label: '底部' },
            { open: 70, high: 88, low: 69, close: 86, volume: 95000, timestamp: generateTimestamp(baseTime, 6), label: '突破!' },
            { open: 86, high: 100, low: 84, close: 98, volume: 90000, timestamp: generateTimestamp(baseTime, 7), label: '續漲' },
        ],
        optimalEntry: { candleIndex: 6, action: 'buy', price: 78, description: '突破上緣時買入' },
        optimalExit: { candleIndex: 7, action: 'sell', price: 98, description: '達到目標價賣出' },
        stopLoss: 68,
        takeProfit: 95,
        expectedDirection: 'up',
        difficulty: 'medium',
    },

    // ==================== V型底 (V-Bottom) ====================
    {
        id: 'vb-001',
        patternType: 'v-bottom',
        name: 'V型底練習 1',
        description: '急跌後快速反彈，觀察追漲時機',
        candles: [
            { open: 100, high: 102, low: 88, close: 90, volume: 60000, timestamp: generateTimestamp(baseTime, 0), label: '下跌' },
            { open: 90, high: 91, low: 75, close: 78, volume: 75000, timestamp: generateTimestamp(baseTime, 1), label: '急跌' },
            { open: 78, high: 80, low: 60, close: 62, volume: 95000, timestamp: generateTimestamp(baseTime, 2), label: 'V底' },
            { open: 62, high: 82, low: 61, close: 80, volume: 100000, timestamp: generateTimestamp(baseTime, 3), label: '急彈' },
            { open: 80, high: 95, low: 78, close: 93, volume: 85000, timestamp: generateTimestamp(baseTime, 4), label: '續漲' },
            { open: 93, high: 108, low: 91, close: 105, volume: 80000, timestamp: generateTimestamp(baseTime, 5), label: '大漲' },
        ],
        optimalEntry: { candleIndex: 3, action: 'buy', price: 72, description: '確認反彈後買入' },
        optimalExit: { candleIndex: 5, action: 'sell', price: 105, description: '達到目標價賣出' },
        stopLoss: 58,
        takeProfit: 102,
        expectedDirection: 'up',
        difficulty: 'hard',
    },

    // ==================== 倒V型頂 (V-Top) ====================
    {
        id: 'vt-001',
        patternType: 'v-top',
        name: '倒V型頂練習 1',
        description: '急漲後快速下跌，觀察做空時機',
        candles: [
            { open: 70, high: 82, low: 68, close: 80, volume: 60000, timestamp: generateTimestamp(baseTime, 0), label: '上漲' },
            { open: 80, high: 95, low: 78, close: 93, volume: 75000, timestamp: generateTimestamp(baseTime, 1), label: '急漲' },
            { open: 93, high: 110, low: 92, close: 108, volume: 95000, timestamp: generateTimestamp(baseTime, 2), label: '倒V頂' },
            { open: 108, high: 109, low: 88, close: 90, volume: 100000, timestamp: generateTimestamp(baseTime, 3), label: '急跌' },
            { open: 90, high: 92, low: 75, close: 78, volume: 85000, timestamp: generateTimestamp(baseTime, 4), label: '續跌' },
            { open: 78, high: 80, low: 65, close: 68, volume: 80000, timestamp: generateTimestamp(baseTime, 5), label: '大跌' },
        ],
        optimalEntry: { candleIndex: 3, action: 'sell', price: 98, description: '確認下跌後做空' },
        optimalExit: { candleIndex: 5, action: 'buy', price: 68, description: '達到目標價回補' },
        stopLoss: 112,
        takeProfit: 65,
        expectedDirection: 'down',
        difficulty: 'hard',
    },

    // ==================== 晨星 (Morning Star) ====================
    {
        id: 'ms-001',
        patternType: 'morning-star',
        name: '晨星練習 1',
        description: '三根K線組成的底部反轉型態',
        candles: [
            { open: 90, high: 92, low: 78, close: 80, volume: 55000, timestamp: generateTimestamp(baseTime, 0), label: '下跌' },
            { open: 80, high: 82, low: 68, close: 70, volume: 65000, timestamp: generateTimestamp(baseTime, 1), label: '長黑K' },
            { open: 70, high: 74, low: 65, close: 72, volume: 45000, timestamp: generateTimestamp(baseTime, 2), label: '十字星' },
            { open: 72, high: 88, low: 71, close: 86, volume: 80000, timestamp: generateTimestamp(baseTime, 3), label: '長紅K' },
            { open: 86, high: 98, low: 84, close: 95, volume: 75000, timestamp: generateTimestamp(baseTime, 4), label: '續漲' },
            { open: 95, high: 108, low: 93, close: 105, volume: 70000, timestamp: generateTimestamp(baseTime, 5), label: '上漲' },
        ],
        optimalEntry: { candleIndex: 3, action: 'buy', price: 80, description: '晨星確認後買入' },
        optimalExit: { candleIndex: 5, action: 'sell', price: 105, description: '達到目標價賣出' },
        stopLoss: 64,
        takeProfit: 102,
        expectedDirection: 'up',
        difficulty: 'easy',
    },
    {
        id: 'ms-002',
        patternType: 'morning-star',
        name: '晨星練習 2',
        description: '帶有跳空的完美晨星型態',
        candles: [
            { open: 85, high: 86, low: 72, close: 74, volume: 50000, timestamp: generateTimestamp(baseTime, 0) },
            { open: 74, high: 75, low: 60, close: 62, volume: 70000, timestamp: generateTimestamp(baseTime, 1), label: '長黑K' },
            { open: 58, high: 62, low: 55, close: 60, volume: 40000, timestamp: generateTimestamp(baseTime, 2), label: '跳空十字星' },
            { open: 64, high: 82, low: 63, close: 80, volume: 85000, timestamp: generateTimestamp(baseTime, 3), label: '跳空長紅K' },
            { open: 80, high: 95, low: 78, close: 92, volume: 75000, timestamp: generateTimestamp(baseTime, 4), label: '續漲' },
        ],
        optimalEntry: { candleIndex: 3, action: 'buy', price: 72, description: '晨星確認後買入' },
        optimalExit: { candleIndex: 4, action: 'sell', price: 92, description: '達到目標價賣出' },
        stopLoss: 54,
        takeProfit: 90,
        expectedDirection: 'up',
        difficulty: 'medium',
    },

    // ==================== 夜星 (Evening Star) ====================
    {
        id: 'es-001',
        patternType: 'evening-star',
        name: '夜星練習 1',
        description: '三根K線組成的頂部反轉型態',
        candles: [
            { open: 80, high: 92, low: 78, close: 90, volume: 55000, timestamp: generateTimestamp(baseTime, 0), label: '上漲' },
            { open: 90, high: 105, low: 88, close: 102, volume: 65000, timestamp: generateTimestamp(baseTime, 1), label: '長紅K' },
            { open: 102, high: 108, low: 100, close: 104, volume: 45000, timestamp: generateTimestamp(baseTime, 2), label: '十字星' },
            { open: 104, high: 105, low: 88, close: 90, volume: 80000, timestamp: generateTimestamp(baseTime, 3), label: '長黑K' },
            { open: 90, high: 92, low: 78, close: 80, volume: 75000, timestamp: generateTimestamp(baseTime, 4), label: '續跌' },
            { open: 80, high: 82, low: 68, close: 70, volume: 70000, timestamp: generateTimestamp(baseTime, 5), label: '下跌' },
        ],
        optimalEntry: { candleIndex: 3, action: 'sell', price: 96, description: '夜星確認後做空' },
        optimalExit: { candleIndex: 5, action: 'buy', price: 70, description: '達到目標價回補' },
        stopLoss: 110,
        takeProfit: 68,
        expectedDirection: 'down',
        difficulty: 'easy',
    },
    {
        id: 'es-002',
        patternType: 'evening-star',
        name: '夜星練習 2',
        description: '帶有跳空的完美夜星型態',
        candles: [
            { open: 75, high: 88, low: 74, close: 86, volume: 50000, timestamp: generateTimestamp(baseTime, 0) },
            { open: 86, high: 102, low: 85, close: 100, volume: 70000, timestamp: generateTimestamp(baseTime, 1), label: '長紅K' },
            { open: 105, high: 110, low: 102, close: 106, volume: 40000, timestamp: generateTimestamp(baseTime, 2), label: '跳空十字星' },
            { open: 102, high: 103, low: 85, close: 88, volume: 85000, timestamp: generateTimestamp(baseTime, 3), label: '跳空長黑K' },
            { open: 88, high: 90, low: 72, close: 75, volume: 75000, timestamp: generateTimestamp(baseTime, 4), label: '續跌' },
        ],
        optimalEntry: { candleIndex: 3, action: 'sell', price: 95, description: '夜星確認後做空' },
        optimalExit: { candleIndex: 4, action: 'buy', price: 75, description: '達到目標價回補' },
        stopLoss: 112,
        takeProfit: 72,
        expectedDirection: 'down',
        difficulty: 'medium',
    },

    // ==================== 看漲吞噬 (Bullish Engulfing) ====================
    {
        id: 'be-001',
        patternType: 'bullish-engulfing',
        name: '看漲吞噬練習 1',
        description: '陽線完全包覆前一根陰線，強烈買入信號',
        candles: [
            { open: 90, high: 92, low: 80, close: 82, volume: 55000, timestamp: generateTimestamp(baseTime, 0), label: '下跌' },
            { open: 82, high: 84, low: 72, close: 74, volume: 60000, timestamp: generateTimestamp(baseTime, 1), label: '續跌' },
            { open: 74, high: 76, low: 68, close: 70, volume: 65000, timestamp: generateTimestamp(baseTime, 2), label: '陰線' },
            { open: 68, high: 85, low: 66, close: 82, volume: 100000, timestamp: generateTimestamp(baseTime, 3), label: '吞噬陽線' },
            { open: 82, high: 95, low: 80, close: 92, volume: 80000, timestamp: generateTimestamp(baseTime, 4), label: '續漲' },
            { open: 92, high: 105, low: 90, close: 102, volume: 75000, timestamp: generateTimestamp(baseTime, 5), label: '上漲' },
        ],
        optimalEntry: { candleIndex: 3, action: 'buy', price: 76, description: '看漲吞噬確認後買入' },
        optimalExit: { candleIndex: 5, action: 'sell', price: 102, description: '達到目標價賣出' },
        stopLoss: 64,
        takeProfit: 100,
        expectedDirection: 'up',
        difficulty: 'easy',
    },

    // ==================== 看跌吞噬 (Bearish Engulfing) ====================
    {
        id: 'bre-001',
        patternType: 'bearish-engulfing',
        name: '看跌吞噬練習 1',
        description: '陰線完全包覆前一根陽線，強烈賣出信號',
        candles: [
            { open: 70, high: 82, low: 68, close: 80, volume: 55000, timestamp: generateTimestamp(baseTime, 0), label: '上漲' },
            { open: 80, high: 92, low: 78, close: 90, volume: 60000, timestamp: generateTimestamp(baseTime, 1), label: '續漲' },
            { open: 90, high: 98, low: 88, close: 96, volume: 65000, timestamp: generateTimestamp(baseTime, 2), label: '陽線' },
            { open: 98, high: 100, low: 82, close: 85, volume: 100000, timestamp: generateTimestamp(baseTime, 3), label: '吞噬陰線' },
            { open: 85, high: 88, low: 72, close: 75, volume: 80000, timestamp: generateTimestamp(baseTime, 4), label: '續跌' },
            { open: 75, high: 78, low: 62, close: 65, volume: 75000, timestamp: generateTimestamp(baseTime, 5), label: '下跌' },
        ],
        optimalEntry: { candleIndex: 3, action: 'sell', price: 92, description: '看跌吞噬確認後做空' },
        optimalExit: { candleIndex: 5, action: 'buy', price: 65, description: '達到目標價回補' },
        stopLoss: 102,
        takeProfit: 62,
        expectedDirection: 'down',
        difficulty: 'easy',
    },

    // ==================== 錘子線 (Hammer) ====================
    {
        id: 'hm-001',
        patternType: 'hammer',
        name: '錘子線練習 1',
        description: '下跌趨勢中出現長下影線，預示反轉',
        candles: [
            { open: 95, high: 96, low: 85, close: 87, volume: 50000, timestamp: generateTimestamp(baseTime, 0), label: '下跌' },
            { open: 87, high: 88, low: 78, close: 80, volume: 55000, timestamp: generateTimestamp(baseTime, 1), label: '續跌' },
            { open: 80, high: 82, low: 72, close: 74, volume: 60000, timestamp: generateTimestamp(baseTime, 2), label: '下跌' },
            { open: 74, high: 78, low: 58, close: 76, volume: 90000, timestamp: generateTimestamp(baseTime, 3), label: '錘子線' },
            { open: 76, high: 90, low: 75, close: 88, volume: 80000, timestamp: generateTimestamp(baseTime, 4), label: '反彈' },
            { open: 88, high: 100, low: 86, close: 98, volume: 75000, timestamp: generateTimestamp(baseTime, 5), label: '上漲' },
        ],
        optimalEntry: { candleIndex: 4, action: 'buy', price: 82, description: '錘子線確認後買入' },
        optimalExit: { candleIndex: 5, action: 'sell', price: 98, description: '達到目標價賣出' },
        stopLoss: 56,
        takeProfit: 95,
        expectedDirection: 'up',
        difficulty: 'easy',
    },

    // ==================== 流星線 (Shooting Star) ====================
    {
        id: 'ss-001',
        patternType: 'shooting-star',
        name: '流星線練習 1',
        description: '上漲趨勢中出現長上影線，預示反轉',
        candles: [
            { open: 70, high: 82, low: 68, close: 80, volume: 50000, timestamp: generateTimestamp(baseTime, 0), label: '上漲' },
            { open: 80, high: 90, low: 78, close: 88, volume: 55000, timestamp: generateTimestamp(baseTime, 1), label: '續漲' },
            { open: 88, high: 98, low: 86, close: 96, volume: 60000, timestamp: generateTimestamp(baseTime, 2), label: '上漲' },
            { open: 96, high: 115, low: 94, close: 98, volume: 90000, timestamp: generateTimestamp(baseTime, 3), label: '流星線' },
            { open: 98, high: 100, low: 85, close: 88, volume: 80000, timestamp: generateTimestamp(baseTime, 4), label: '下跌' },
            { open: 88, high: 90, low: 75, close: 78, volume: 75000, timestamp: generateTimestamp(baseTime, 5), label: '續跌' },
        ],
        optimalEntry: { candleIndex: 4, action: 'sell', price: 94, description: '流星線確認後做空' },
        optimalExit: { candleIndex: 5, action: 'buy', price: 78, description: '達到目標價回補' },
        stopLoss: 117,
        takeProfit: 75,
        expectedDirection: 'down',
        difficulty: 'easy',
    },

    // ==================== 圓弧底 (Rounding Bottom) ====================
    {
        id: 'rb-001',
        patternType: 'rounding-bottom',
        name: '圓弧底型態練習 1',
        description: '長期底部反轉型態，觀察買入時機',
        candles: [
            { open: 80, high: 82, low: 72, close: 74, volume: 50000, timestamp: generateTimestamp(baseTime, 0), label: '下跌' },
            { open: 74, high: 76, low: 68, close: 70, volume: 48000, timestamp: generateTimestamp(baseTime, 1) },
            { open: 70, high: 72, low: 65, close: 67, volume: 42000, timestamp: generateTimestamp(baseTime, 2), label: '底部左側' },
            { open: 67, high: 69, low: 64, close: 66, volume: 38000, timestamp: generateTimestamp(baseTime, 3), label: '圓弧底部' },
            { open: 66, high: 70, low: 65, close: 68, volume: 40000, timestamp: generateTimestamp(baseTime, 4) },
            { open: 68, high: 74, low: 67, close: 72, volume: 45000, timestamp: generateTimestamp(baseTime, 5), label: '底部右側' },
            { open: 72, high: 80, low: 71, close: 78, volume: 55000, timestamp: generateTimestamp(baseTime, 6), label: '開始上漲' },
            { open: 78, high: 92, low: 77, close: 90, volume: 85000, timestamp: generateTimestamp(baseTime, 7), label: '突破!' },
            { open: 90, high: 102, low: 88, close: 100, volume: 80000, timestamp: generateTimestamp(baseTime, 8), label: '續漲' },
        ],
        optimalEntry: { candleIndex: 7, action: 'buy', price: 85, description: '突破頸線時買入' },
        optimalExit: { candleIndex: 8, action: 'sell', price: 100, description: '達到目標價賣出' },
        stopLoss: 70,
        takeProfit: 98,
        expectedDirection: 'up',
        difficulty: 'hard',
    },

    // ==================== 圓弧頂 (Rounding Top) ====================
    {
        id: 'rt-001',
        patternType: 'rounding-top',
        name: '圓弧頂型態練習 1',
        description: '長期頂部反轉型態，觀察做空時機',
        candles: [
            { open: 70, high: 78, low: 68, close: 76, volume: 50000, timestamp: generateTimestamp(baseTime, 0), label: '上漲' },
            { open: 76, high: 82, low: 74, close: 80, volume: 48000, timestamp: generateTimestamp(baseTime, 1) },
            { open: 80, high: 86, low: 78, close: 84, volume: 42000, timestamp: generateTimestamp(baseTime, 2), label: '頂部左側' },
            { open: 84, high: 88, low: 82, close: 86, volume: 38000, timestamp: generateTimestamp(baseTime, 3), label: '圓弧頂部' },
            { open: 86, high: 88, low: 82, close: 84, volume: 40000, timestamp: generateTimestamp(baseTime, 4) },
            { open: 84, high: 86, low: 78, close: 80, volume: 45000, timestamp: generateTimestamp(baseTime, 5), label: '頂部右側' },
            { open: 80, high: 82, low: 72, close: 74, volume: 55000, timestamp: generateTimestamp(baseTime, 6), label: '開始下跌' },
            { open: 74, high: 76, low: 62, close: 65, volume: 85000, timestamp: generateTimestamp(baseTime, 7), label: '跌破!' },
            { open: 65, high: 68, low: 55, close: 58, volume: 80000, timestamp: generateTimestamp(baseTime, 8), label: '續跌' },
        ],
        optimalEntry: { candleIndex: 7, action: 'sell', price: 70, description: '跌破頸線時做空' },
        optimalExit: { candleIndex: 8, action: 'buy', price: 58, description: '達到目標價回補' },
        stopLoss: 82,
        takeProfit: 55,
        expectedDirection: 'down',
        difficulty: 'hard',
    },

    // ==================== 對稱三角形 (Symmetric Triangle) ====================
    {
        id: 'st-001',
        patternType: 'symmetric-triangle',
        name: '對稱三角形練習 1',
        description: '收斂整理後向上突破',
        candles: [
            { open: 100, high: 115, low: 90, close: 108, volume: 60000, timestamp: generateTimestamp(baseTime, 0), label: 'W1' },
            { open: 108, high: 112, low: 92, close: 95, volume: 55000, timestamp: generateTimestamp(baseTime, 1), label: 'W2' },
            { open: 95, high: 108, low: 94, close: 105, volume: 50000, timestamp: generateTimestamp(baseTime, 2), label: 'W3' },
            { open: 105, high: 108, low: 96, close: 98, volume: 48000, timestamp: generateTimestamp(baseTime, 3), label: 'W4' },
            { open: 98, high: 105, low: 97, close: 103, volume: 45000, timestamp: generateTimestamp(baseTime, 4), label: 'W5' },
            { open: 103, high: 120, low: 102, close: 118, volume: 100000, timestamp: generateTimestamp(baseTime, 5), label: '突破!' },
            { open: 118, high: 130, low: 116, close: 128, volume: 90000, timestamp: generateTimestamp(baseTime, 6), label: '上漲' },
        ],
        optimalEntry: { candleIndex: 5, action: 'buy', price: 108, description: '突破上緣時買入' },
        optimalExit: { candleIndex: 6, action: 'sell', price: 128, description: '達到目標價賣出' },
        stopLoss: 95,
        takeProfit: 130,
        expectedDirection: 'up',
        difficulty: 'medium',
    },

    // ==================== 矩形整理 (Rectangle) ====================
    {
        id: 'rect-001',
        patternType: 'rectangle',
        name: '矩形整理練習 1',
        description: '箱型整理後向上突破',
        candles: [
            { open: 55, high: 60, low: 51, close: 52, volume: 50000, timestamp: generateTimestamp(baseTime, 0), label: '測底' },
            { open: 52, high: 59, low: 51, close: 58, volume: 48000, timestamp: generateTimestamp(baseTime, 1), label: '反彈' },
            { open: 58, high: 60, low: 53, close: 54, volume: 45000, timestamp: generateTimestamp(baseTime, 2), label: '回落' },
            { open: 54, high: 60, low: 53, close: 59, volume: 52000, timestamp: generateTimestamp(baseTime, 3), label: '測頂' },
            { open: 59, high: 60, low: 52, close: 53, volume: 46000, timestamp: generateTimestamp(baseTime, 4), label: '回落' },
            { open: 53, high: 58, low: 52, close: 57, volume: 50000, timestamp: generateTimestamp(baseTime, 5), label: '蓄勢' },
            { open: 57, high: 70, low: 56, close: 68, volume: 95000, timestamp: generateTimestamp(baseTime, 6), label: '突破!' },
            { open: 68, high: 78, low: 66, close: 75, volume: 85000, timestamp: generateTimestamp(baseTime, 7), label: '目標達' },
        ],
        optimalEntry: { candleIndex: 6, action: 'buy', price: 62, description: '突破箱頂時買入' },
        optimalExit: { candleIndex: 7, action: 'sell', price: 75, description: '達到目標價賣出' },
        stopLoss: 50,
        takeProfit: 70,
        expectedDirection: 'up',
        difficulty: 'easy',
    },

    // ==================== 杯柄型態 (Cup and Handle) ====================
    {
        id: 'ch-001',
        patternType: 'cup-and-handle',
        name: '杯柄型態練習 1',
        description: '杯柄型態突破，預示大幅上漲',
        candles: [
            { open: 100, high: 102, low: 90, close: 92, volume: 55000, timestamp: generateTimestamp(baseTime, 0), label: '下跌' },
            { open: 92, high: 93, low: 80, close: 82, volume: 60000, timestamp: generateTimestamp(baseTime, 1), label: '續跌' },
            { open: 82, high: 83, low: 70, close: 72, volume: 65000, timestamp: generateTimestamp(baseTime, 2), label: '杯底' },
            { open: 72, high: 85, low: 71, close: 83, volume: 55000, timestamp: generateTimestamp(baseTime, 3), label: '反彈' },
            { open: 83, high: 100, low: 82, close: 98, volume: 70000, timestamp: generateTimestamp(baseTime, 4), label: '回升' },
            { open: 98, high: 100, low: 90, close: 92, volume: 40000, timestamp: generateTimestamp(baseTime, 5), label: '杯柄' },
            { open: 92, high: 95, low: 88, close: 94, volume: 45000, timestamp: generateTimestamp(baseTime, 6), label: '整理' },
            { open: 94, high: 115, low: 93, close: 112, volume: 110000, timestamp: generateTimestamp(baseTime, 7), label: '突破!' },
            { open: 112, high: 130, low: 110, close: 128, volume: 100000, timestamp: generateTimestamp(baseTime, 8), label: '大漲' },
        ],
        optimalEntry: { candleIndex: 7, action: 'buy', price: 102, description: '突破杯柄時買入' },
        optimalExit: { candleIndex: 8, action: 'sell', price: 128, description: '達到目標價賣出' },
        stopLoss: 85,
        takeProfit: 130,
        expectedDirection: 'up',
        difficulty: 'hard',
    },

    // ==================== 島狀反轉（頂）(Island Reversal Top) ====================
    {
        id: 'irt-001',
        patternType: 'island-reversal-top',
        name: '島狀反轉（頂）練習 1',
        description: '高可靠度的頂部反轉訊號',
        candles: [
            { open: 80, high: 88, low: 78, close: 86, volume: 55000, timestamp: generateTimestamp(baseTime, 0) },
            { open: 86, high: 95, low: 85, close: 93, volume: 70000, timestamp: generateTimestamp(baseTime, 1), label: '上漲' },
            { open: 98, high: 105, low: 96, close: 102, volume: 90000, timestamp: generateTimestamp(baseTime, 2), label: '跳空高開' },
            { open: 102, high: 106, low: 98, close: 100, volume: 65000, timestamp: generateTimestamp(baseTime, 3), label: '島上整理' },
            { open: 100, high: 103, low: 97, close: 99, volume: 60000, timestamp: generateTimestamp(baseTime, 4) },
            { open: 92, high: 94, low: 82, close: 84, volume: 95000, timestamp: generateTimestamp(baseTime, 5), label: '跳空低開' },
            { open: 84, high: 86, low: 75, close: 78, volume: 85000, timestamp: generateTimestamp(baseTime, 6), label: '續跌' },
            { open: 78, high: 80, low: 68, close: 70, volume: 80000, timestamp: generateTimestamp(baseTime, 7), label: '大跌' },
        ],
        optimalEntry: { candleIndex: 5, action: 'sell', price: 90, description: '島狀反轉確認後做空' },
        optimalExit: { candleIndex: 7, action: 'buy', price: 70, description: '達到目標價回補' },
        stopLoss: 105,
        takeProfit: 68,
        expectedDirection: 'down',
        difficulty: 'hard',
    },

    // ==================== 島狀反轉（底）(Island Reversal Bottom) ====================
    {
        id: 'irb-001',
        patternType: 'island-reversal-bottom',
        name: '島狀反轉（底）練習 1',
        description: '高可靠度的底部反轉訊號',
        candles: [
            { open: 90, high: 92, low: 82, close: 84, volume: 55000, timestamp: generateTimestamp(baseTime, 0) },
            { open: 84, high: 86, low: 75, close: 78, volume: 70000, timestamp: generateTimestamp(baseTime, 1), label: '下跌' },
            { open: 72, high: 75, low: 68, close: 70, volume: 90000, timestamp: generateTimestamp(baseTime, 2), label: '跳空低開' },
            { open: 70, high: 74, low: 68, close: 72, volume: 65000, timestamp: generateTimestamp(baseTime, 3), label: '島上整理' },
            { open: 72, high: 75, low: 70, close: 73, volume: 60000, timestamp: generateTimestamp(baseTime, 4) },
            { open: 80, high: 90, low: 78, close: 88, volume: 95000, timestamp: generateTimestamp(baseTime, 5), label: '跳空高開' },
            { open: 88, high: 98, low: 86, close: 96, volume: 85000, timestamp: generateTimestamp(baseTime, 6), label: '續漲' },
            { open: 96, high: 108, low: 94, close: 105, volume: 80000, timestamp: generateTimestamp(baseTime, 7), label: '大漲' },
        ],
        optimalEntry: { candleIndex: 5, action: 'buy', price: 82, description: '島狀反轉確認後買入' },
        optimalExit: { candleIndex: 7, action: 'sell', price: 105, description: '達到目標價賣出' },
        stopLoss: 68,
        takeProfit: 102,
        expectedDirection: 'up',
        difficulty: 'hard',
    },
];

// Get scenarios by pattern type
export function getScenariosByPattern(patternType: PatternType): PatternScenario[] {
    return PATTERN_SCENARIOS.filter(s => s.patternType === patternType);
}

// Get a random scenario
export function getRandomScenario(): PatternScenario {
    const index = Math.floor(Math.random() * PATTERN_SCENARIOS.length);
    return PATTERN_SCENARIOS[index];
}

// Get scenarios by difficulty
export function getScenariosByDifficulty(difficulty: 'easy' | 'medium' | 'hard'): PatternScenario[] {
    return PATTERN_SCENARIOS.filter(s => s.difficulty === difficulty);
}

// Generate recognition questions
export function generateRecognitionQuestions(count: number = 5): RecognitionQuestion[] {
    const shuffled = [...PATTERN_SCENARIOS].sort(() => Math.random() - 0.5);
    const selected = shuffled.slice(0, count);
    
    const allPatternTypes = Object.keys(PATTERN_INFO) as PatternType[];
    
    return selected.map((scenario, index) => {
        // Generate 4 options including the correct answer
        const otherPatterns = allPatternTypes.filter(p => p !== scenario.patternType);
        const shuffledOthers = otherPatterns.sort(() => Math.random() - 0.5).slice(0, 3);
        const options = [scenario.patternType, ...shuffledOthers].sort(() => Math.random() - 0.5);
        
        return {
            id: `q-${index}-${Date.now()}`,
            scenarioId: scenario.id,
            correctAnswer: scenario.patternType,
            options,
            timeLimit: 30,
        };
    });
}

// Get all available patterns for selection
export function getAvailablePatterns(): PatternInfo[] {
    const availableTypes = new Set(PATTERN_SCENARIOS.map(s => s.patternType));
    return Object.values(PATTERN_INFO).filter(p => availableTypes.has(p.id));
}
